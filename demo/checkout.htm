
<script src="../dist/checkout-components.js"></script>

<style>
    body {
        background-color: white;
    }
</style>

<h1>Checkout!</h1>

<button onclick="authorize()">Authorize Payment</button>

<script>
    let ecToken;

    var checkout = checkoutComponents.PayPalCheckout.attach({

        onEnter: function() {

            if (this.props.token) {

                ecToken = this.props.token;
                console.log('sent paypal token!', ecToken);

            } else if (this.props.getToken) {

                this.props.getToken().then(function(token) {
                    ecToken = token;
                    console.log('got paypal token!', ecToken);
                });

            } else {

                throw new Error('Expected either props.token or props.getToken');
            }
        },

        defaultProps: {

            getToken() {
                console.log('getting token from url', window.location.href);
                return window.location.href.match(/token=((EC-)?[A-Z0-9]{17})/)[1];
            }
        }
    });

    function authorize() {
        if (checkout.props.onPaymentAuthorize) {
            checkout.props.onPaymentAuthorize({
                token: ecToken,
                payerID: 'SD8778VSD7VD6SV',
                returnUrl: 'merchant_legacy.htm'
            });
        }
    }
</script>